# 别名优化

[**XML配置**](https://mybatis.org/mybatis-3/zh/configuration.html)**（官网帮助文档）**
 configuration（配置） 

- [properties（属性）](https://mybatis.org/mybatis-3/zh/configuration.html#properties)
- [settings（设置）](https://mybatis.org/mybatis-3/zh/configuration.html#settings)
- [typeAliases（类型别名）](https://mybatis.org/mybatis-3/zh/configuration.html#typeAliases)
- [typeHandlers（类型处理器）](https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers)
- [objectFactory（对象工厂）](https://mybatis.org/mybatis-3/zh/configuration.html#objectFactory)
- [plugins（插件）](https://mybatis.org/mybatis-3/zh/configuration.html#plugins)
- [environments（环境配置）](https://mybatis.org/mybatis-3/zh/configuration.html#environments)
   -  environment（环境变量） 
      - transactionManager（事务管理器）
      - dataSource（数据源）
- [databaseIdProvider（数据库厂商标识）](https://mybatis.org/mybatis-3/zh/configuration.html#databaseIdProvider)
- [mappers（映射器）](https://mybatis.org/mybatis-3/zh/configuration.html#mappers)

## 一、 类型别名（typeAliases）

 类型别名可为 Java 类型设置一个缩写名字。 它仅用于 XML 配置，意在降低冗余的全限定类名书写。  

##### 方式一：
原来是这样：注意resultType：
```xml
<mapper namespace="xleixz.dao.UserMapper">
    <!--select查询语句-->
    <select id="getUserList" resultType="xleixz.pojo.User">
        select *
        from mybatis.user;
    </select>
</mapper>
```

在**核心配置文件mybatis-config.xml**中添加别名配置。
```xml
 <!--可以给实体类起别名-->
    <typeAliases>
        <typeAlias type="xleixz.pojo.User" alias="User"/><!--alias起别名-->
    </typeAliases>
```

这样接口实现类中**resultType值**可优化为：
```xml
<mapper namespace="xleixz.dao.UserMapper">
    <!--select查询语句-->
    <select id="getUserList" resultType="User">
        select *
        from mybatis.user;
    </select>
  </mapper>
```

---

##### 方式二：
也可以指定一个包名，MyBatis 会在包名下面搜索需要的 Java Bean ，比如：
扫描实体类的包，它的默认别名就为这个类的类名，**首字母小写！**

在**核心配置文件mybatis-config.xml**中添加别名配置。
```xml
<!--可以给实体类起别名-->
    <typeAliases>
        <package name="xleixz.pojo"/>
    </typeAliases>
```

这样接口实现类中**resultType值**可优化为：（建议小写）
```xml
 <!--select查询语句-->
    <select id="getUserList" resultType="user">
        select *
        from mybatis.user;
    </select>
```

---

##### 方法三：
若有注解，则别名为其注解值。  
在实体类上方添加注解
```java
@Alias("user")
public class User {
}
```

---

##### 方法总结和区别：
如果实体类很多，建议使用**方式二；**
**方式一**可以DIY别名，第二种则不行。

下面是一些为常见的 Java 类型内建的类型别名。它们都是不区分大小写的，注意，为了应对原始类型的命名重复，采取了特殊的命名风格。

|  别名  |  映射的类型  |
| --- | --- |
|  _byte  |  byte  |
|  _long  |  long  |
|  _short  |  short  |
|  _int  |  int  |
|  _integer  |  int  |
|  _double  |  double  |
|  _float  |  float  |
|  _boolean  |  boolean  |
|  string  |  String  |
|  byte  |  Byte  |
|  long  |  Long  |
|  short  |  Short  |
|  int  |  Integer  |
|  integer  |  Integer  |
|  double  |  Double  |
|  float  |  Float  |
|  boolean  |  Boolean  |
|  date  |  Date  |
|  decimal  |  BigDecimal  |
|  bigdecimal  |  BigDecimal  |
|  object  |  Object  |
|  map  |  Map  |
|  hashmap  |  HashMap  |
|  list  |  List  |
|  arraylist  |  ArrayList  |
|  collection  |  Collection  |
|  iterator  |  Iterator  |



## 二、 设置（settings）

 这是 MyBatis 中极为重要的调整设置，它们会改变 MyBatis 的运行时行为。 下表描述了设置中各项设置的含义、默认值等。  

| 设置名 | 描述 | 有效值 | 默认值 |
| --- | --- | --- | --- |
|  cacheEnabled  |  全局性地开启或关闭所有映射器配置文件中已配置的任何缓存。  |  true &#124; false  |  true  |
|  lazyLoadingEnabled  |  延迟加载的全局开关。当开启时，所有关联对象都会延迟加载。 特定关联关系中可通过设置 fetchType 属性来覆盖该项的开关状态。  |  true &#124; false  |  false  |
|  aggressiveLazyLoading  |  开启时，任一方法的调用都会加载该对象的所有延迟加载属性。 否则，每个延迟加载属性会按需加载（参考 lazyLoadTriggerMethods)。  |  true &#124; false  |  false （在 3.4.1 及之前的版本中默认为 true）  |
|  multipleResultSetsEnabled  |  是否允许单个语句返回多结果集（需要数据库驱动支持）。  |  true &#124; false  |  true  |
|  useColumnLabel  |  使用列标签代替列名。实际表现依赖于数据库驱动，具体可参考数据库驱动的相关文档，或通过对比测试来观察。  |  true &#124; false  |  true  |
|  useGeneratedKeys  |  允许 JDBC 支持自动生成主键，需要数据库驱动支持。如果设置为 true，将强制使用自动生成主键。尽管一些数据库驱动不支持此特性，但仍可正常工作（如 Derby）。  |  true &#124; false  |  False  |
|  autoMappingBehavior  |  指定 MyBatis 应如何自动映射列到字段或属性。 NONE 表示关闭自动映射；PARTIAL 只会自动映射没有定义嵌套结果映射的字段。 FULL 会自动映射任何复杂的结果集（无论是否嵌套）。  |  NONE, PARTIAL, FULL  |  PARTIAL  |
|  autoMappingUnknownColumnBehavior  |  			 指定发现自动映射目标未知列（或未知属性类型）的行为。 
- NONE: 不做任何反应
- WARNING: 输出警告日志（'org.apache.ibatis.session.AutoMappingUnknownColumnBehavior' 的日志等级必须设置为 WARN）
- FAILING: 映射失败 (抛出 SqlSessionException)
 |  NONE, WARNING, FAILING  |  NONE  |
|  defaultExecutorType  |  配置默认的执行器。SIMPLE 就是普通的执行器；REUSE 执行器会重用预处理语句（PreparedStatement）； BATCH 执行器不仅重用语句还会执行批量更新。  |  SIMPLE REUSE BATCH  |  SIMPLE  |
|  defaultStatementTimeout  |  设置超时时间，它决定数据库驱动等待数据库响应的秒数。  |  任意正整数  |  未设置 (null)  |
|  defaultFetchSize  |  为驱动的结果集获取数量（fetchSize）设置一个建议值。此参数只可以在查询设置中被覆盖。  |  任意正整数  |  未设置 (null)  |
|  defaultResultSetType  |  指定语句默认的滚动策略。（新增于 3.5.2）  |  FORWARD_ONLY &#124; SCROLL_SENSITIVE &#124; SCROLL_INSENSITIVE &#124; DEFAULT（等同于未设置）  |  未设置 (null)  |
|  safeRowBoundsEnabled  |  是否允许在嵌套语句中使用分页（RowBounds）。如果允许使用则设置为 false。  |  true &#124; false  |  False  |
|  safeResultHandlerEnabled  |  是否允许在嵌套语句中使用结果处理器（ResultHandler）。如果允许使用则设置为 false。  |  true &#124; false  |  True  |
|  mapUnderscoreToCamelCase  |  是否开启驼峰命名自动映射，即从经典数据库列名 A_COLUMN 映射到经典 Java 属性名 aColumn。  |  true &#124; false  |  False  |
|  localCacheScope  |  MyBatis 利用本地缓存机制（Local Cache）防止循环引用和加速重复的嵌套查询。 默认值为 SESSION，会缓存一个会话中执行的所有查询。 若设置值为 STATEMENT，本地缓存将仅用于执行语句，对相同 SqlSession 的不同查询将不会进行缓存。  |  SESSION &#124; STATEMENT  |  SESSION  |
|  jdbcTypeForNull  |  当没有为参数指定特定的 JDBC 类型时，空值的默认 JDBC 类型。 某些数据库驱动需要指定列的 JDBC 类型，多数情况直接用一般类型即可，比如 NULL、VARCHAR 或 OTHER。  |  JdbcType 常量，常用值：NULL、VARCHAR 或 OTHER。  |  OTHER  |
|  lazyLoadTriggerMethods  |  指定对象的哪些方法触发一次延迟加载。  |  用逗号分隔的方法列表。  |  equals,clone,hashCode,toString  |
|  defaultScriptingLanguage  |  指定动态 SQL 生成使用的默认脚本语言。  |  一个类型别名或全限定类名。  |  org.apache.ibatis.scripting.xmltags.XMLLanguageDriver  |
|  defaultEnumTypeHandler  |  指定 Enum 使用的默认 TypeHandler 。（新增于 3.4.5）  |  一个类型别名或全限定类名。  |  org.apache.ibatis.type.EnumTypeHandler  |
|  callSettersOnNulls  |  指定当结果集中值为 null 的时候是否调用映射对象的 setter（map 对象时为 put）方法，这在依赖于 Map.keySet() 或 null 值进行初始化时比较有用。注意基本类型（int、boolean 等）是不能设置成 null 的。  |  true &#124; false  |  false  |
|  returnInstanceForEmptyRow  |  				当返回行的所有列都是空时，MyBatis默认返回 null。 				当开启这个设置时，MyBatis会返回一个空实例。 				请注意，它也适用于嵌套的结果集（如集合或关联）。（新增于 3.4.2）  |  true &#124; false  |  false  |
|  logPrefix  |  指定 MyBatis 增加到日志名称的前缀。  |  任何字符串  |  未设置  |
|  logImpl  |  指定 MyBatis 所用日志的具体实现，未指定时将自动查找。  |  SLF4J &#124; LOG4J(deprecated since 3.5.9) &#124; LOG4J2 &#124; JDK_LOGGING &#124; COMMONS_LOGGING &#124; STDOUT_LOGGING &#124; NO_LOGGING  |  未设置  |
|  proxyFactory  |  指定 Mybatis 创建可延迟加载对象所用到的代理工具。  |  CGLIB &#124; JAVASSIST  |  JAVASSIST （MyBatis 3.3 以上）  |
|  vfsImpl  |  指定 VFS 的实现  |  自定义 VFS 的实现的类全限定名，以逗号分隔。  |  未设置  |
|  useActualParamName  |  允许使用方法签名中的名称作为语句参数名称。 		 为了使用该特性，你的项目必须采用 Java 8 编译，并且加上 -parameters 选项。（新增于 3.4.1）  |  true &#124; false  |  true  |
|  configurationFactory  |  指定一个提供 Configuration 实例的类。 		 这个被返回的 Configuration 实例用来加载被反序列化对象的延迟加载属性值。 		 这个类必须包含一个签名为static Configuration getConfiguration() 的方法。（新增于 3.2.3）  |  一个类型别名或完全限定类名。  |  未设置  |
|  shrinkWhitespacesInSql  |  从SQL中删除多余的空格字符。请注意，这也会影响SQL中的文字字符串。 (新增于 3.5.5)  |  true &#124; false  |  false  |
|  defaultSqlProviderType  |  Specifies an sql provider class that holds provider method (Since 3.5.6). This class apply to the type(or value) attribute on sql provider annotation(e.g. @SelectProvider), when these attribute was omitted.  |  A type alias or fully qualified class name  |  Not set  |
|  nullableOnForEach  |  Specifies the default value of 'nullable' attribute on 'foreach' tag. (Since 3.5.9)  |  true &#124; false  |  false  |

 一个配置完整的 settings 元素的示例如下：  
```xml
<settings>
  <setting name="cacheEnabled" value="true"/>
  <setting name="lazyLoadingEnabled" value="true"/>
  <setting name="multipleResultSetsEnabled" value="true"/>
  <setting name="useColumnLabel" value="true"/>
  <setting name="useGeneratedKeys" value="false"/>
  <setting name="autoMappingBehavior" value="PARTIAL"/>
  <setting name="autoMappingUnknownColumnBehavior" value="WARNING"/>
  <setting name="defaultExecutorType" value="SIMPLE"/>
  <setting name="defaultStatementTimeout" value="25"/>
  <setting name="defaultFetchSize" value="100"/>
  <setting name="safeRowBoundsEnabled" value="false"/>
  <setting name="mapUnderscoreToCamelCase" value="false"/>
  <setting name="localCacheScope" value="SESSION"/>
  <setting name="jdbcTypeForNull" value="OTHER"/>
  <setting name="lazyLoadTriggerMethods" value="equals,clone,hashCode,toString"/>
</settings>
```
